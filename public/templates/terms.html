<div class="nav-tab">
    <a href data-ng-click="goToDataset()">Return to Dataset</a>
</div>
<div class="row">

    <div class="col-md-12">
        <div class="file-path-info">
            <code>
                {{fileName}}{{path}}
            </code>
        </div>
    </div>
    <div class="col-md-5">
        <div class="panel panel-primary panel-lists">
            <div class="panel-heading  list-controls">
                <span class="panel-title">Terms</span>
                <ul class="nav nav-tabs tabs-small pull-right" data-ng-init="show='all'">
                    <li data-ng-class="{ active: show === 'all' }" data-ng-model="show" data-ng-click="show='all'"><a href >All ({{ all }})</a></li>
                    <li data-ng-class="{ active: show === 'mapped' }" data-ng-model="show" data-ng-click="show='mapped'"><a href >Mapped ({{ mapped }})</a></li>
                    <li data-ng-class="{ active: show === 'unmapped' }" data-ng-model="show" data-ng-click="show='unmapped'"><a href >Unmapped ({{ unmapped }})</a></li>
                </ul>
            </div>
            <div class="panel-body">
                <div class="vertical-scroll" data-scrollable id="histogram-list" data-offset="200" data-ng-style="{ 'max-height': elHeight, 'min-height': elHeight }">
                    <ul class="list-group terminology-list">
                        <li data-ng-repeat="entry in histogramVisible | filter:filterText"
                            class="list-group-item clearfix test-class"
                            data-ng-class="{ 'list-item-selected': entry.value ==  sourceEntry.value, 'list-item-mapped' : mappings[entry.sourceUri] }"
                            data-ng-click="scrollTo({element: '#skos-term-list', direction: 'up'});selectSource(entry);">
                            <span class="term">{{ entry.value }}</span>
                            <span  class="term-mapped" data-ng-show="mappings[entry.sourceUri].prefLabel">
                                <i class="fa fa-link"></i> {{ mappings[entry.sourceUri].prefLabel }}
                                <!-- todo: functionality to delete the term mapping -->
                                <!--<button class="btn btn-danger btn-xs"><i class="fa fa-unlink"></i></button>-->
                            </span>
                            <span class="node-stats badge">{{ entry.count }}</span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-7">
        <div class="panel panel-primary">
            <div class="panel-heading list-controls">
                <ul class="nav nav-tabs tabs-small pull-left" >
                    <li data-ng-class="{ active: activeView == 'vocabulary' }"><a href data-ng-click="vocabularyTab()">Vocabularies</a></li>
                    <li data-ng-class="{ active: activeView == 'skos' }"><a href data-ng-click="skosTab()">Concepts</a></li>
                    <li data-ng-class="{ active: activeView == 'record' }"><a href data-ng-click="recordTab()">Records</a></li>
                </ul>

                <span data-ng-show="activeView == 'skos'" class="pull-right">
                    <span class="label term-matched">matched term</span>
                    <span class="label term-alt">alt term</span>
                    <span class="label term-preferred"><i class="fa fa-star"></i> preferred term</span>
                    <span class="label term-broader">&#8599; <!--<i class="fa fa-expand"></i>--> broader term</span>
                    <span class="label term-narrower">&#8600; <!--<i class="fa fa-compress"></i>-->  narrower term</span>
                </span>
                <span data-ng-show="activeView == 'vocabulary'" class="pull-right">
                    <span class="label term-broader">Available SKOS Vocabularies</span>
                </span>
                <span data-ng-show="activeView == 'record'" class="pull-right">
                    <span class="label term-broader">Records containing "{{ sourceValue }}"</span>
                </span>
            </div>

            <!-- SHOW RECORD -->
            <div data-ng-show="activeView == 'record'">
                <!--todo: this should show an enriched record, and highlight the lines which are enriched-->
                <textarea class="form-control" style="font-family: monospace; font-size: 8pt;"data-scrollable id="records" data-offset="230" data-ng-style="{ 'max-height': elHeight, 'min-height': elHeight }">{{ records }}</textarea>
            </div>

            <div class="panel-body">

                <!-- SHOW SKOS (CONCEPT) -->
                <div data-ng-show="vocabularyList && activeView == 'vocabulary'">
                    <div class="panel panel-default panel-choice">
                        <div class="panel-body" data-ng-repeat="name in vocabularyList" data-ng-click="selectVocabulary(name)">
                            <i data-ng-show="name == vocabulary" class="fa fa-search"></i> <span>{{ name }}</span>
                        </div>
                    </div>
                </div>
                <div data-ng-show="vocabulary && activeView == 'skos'">

                    <div class="input-group input-group-skos-term">
                        <label class="input-group-addon"><i class="fa fa-search"></i> {{ vocabulary }}</label>
                        <input class="form-control" type="text" data-ng-model="sought"/>
                    </div>
                    <div class="alert alert-explain" role="alert" data-ng-show="!sought">
                        <b>Click</b> on a term from the list on the left or <b>enter</b> a term in the search field above
                    </div>
                    <div data-ng-show="initialSearchWait">
                         <i class="fa fa-spinner fa-spin fa-5x"></i>
                    </div>


                    <div data-ng-show="concepts" class="concepts-list vertical-scroll" data-scrollable id="skos-term-list" data-offset="289" data-ng-style="{ 'max-height': elHeight, 'min-height': elHeight }">
                        <div data-ng-repeat="concept in concepts" class="list-group concept-box" data-ng-class="{'concept-selected':mappings[sourceEntry.sourceUri].target == concept.uri }">

                            <progressbar value="concept.proximity" max="1.0" type="success">
                                {{ concept.proximity * 100 | number : 0 }}%
                            </progressbar>
                            <div>
                                <!-- MATCHTED TERM / ALT TERM -->
                                <span data-ng-click="setMapping(concept)"
                                      class="found-term" title="Click to map!">
                                    <span class="label term-matched" data-ng-class="{ 'term-alt' : !concept.preferred }">{{ concept.label }}</span>
                                </span>
                                <!-- PREFERRED TERM -->
                                <span data-ng-show="!concept.preferred"
                                      data-ng-click="selectSought(concept.prefLabel)">
                                    <span class="label term-preferred"><!--&#8594;--><i class="fa fa-star"></i> {{ concept.prefLabel }}</span>
                                </span>
                                <!-- BROADER TERM -->
                                <span ng-show="concept.broader">
                                    <span data-ng-repeat="b in concept.broader"
                                          data-ng-click="selectSought(b.label)"
                                          class="broader-term">
                                         <span class="label term-broader">&#8599; <!--<i class="fa fa-expand"></i>--> {{ b.label }}</span>
                                    </span>
                                </span>
                                <!-- NARROWER TERM -->
                                <span ng-show="concept.narrower">
                                    <span data-ng-repeat="n in concept.narrower"
                                          data-ng-click="selectSought(n.label)"
                                          class="narrower-term">
                                        <span class="label term-narrower">&#8600; <!--<i class="fa fa-compress"></i>--> {{ n.label }}</span>
                                    </span>
                                </span>
                            </div>
                            <div class="concept-bottom">
                                    <a ng-href="{{concept.uri}}" target="_blank">
                                        {{ concept.uri }}
                                    </a>
                                <span>
                                    "{{ concept.conceptScheme }}"
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>

